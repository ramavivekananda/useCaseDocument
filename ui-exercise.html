<script>
    //Users Object
    const users = [
        {
            id: "1",
            name: "Norah"
        },
        {
            id: "2",
            name: "Alyx"
        }
    ],
        accounts = [ // Accounts Object
            {
                account: "IRA-4679",
                user: "1",
                balance: "5175.36"
            },
            {
                account: "AAA-3571",
                user: "1",
                balance: "3106701.85"
            },
            {
                account: "AAA-4671",
                user: "1",
                balance: "138971.19"
            },
            {
                account: "ROT-1687",
                user: "2",
                balance: "2686.00"
            },
            {
                account: "AAA-7894",
                user: "2",
                balance: "68761.32"
            },
            {
                account: "IRA-6818",
                user: "2",
                balance: "564.67"
            },
            {
                account: "IRA-6819",
                user: "2",
                balance: "6564.67"
            }
        ];


    // 1. output  ["Norah | AAA-6818 | 564.67","Norah | AAA-4671 | 138971.19"] 

    const userArrConcatWithStrings = () => {
        let usersArrayList = [];

        for (eachUser of users) {
            let userAccDetails = '';
            const firstResult = accounts.filter((eachUserValue) => {
                if (eachUser.id === eachUserValue.user)
                    userAccDetails += " " + eachUser.name + '|' + eachUserValue.account + '|' + eachUserValue.balance + ",";
            });
            usersArrayList.push(userAccDetails);
        }
        return usersArrayList;
    }

    // 2. filtered by UserName Norah with all account types (ROT, IRA, AAA) 

    let userNorahAccList = [];

    // Expose outside , logic to filter with particular User name or filter with all Users from the Accounts Obj 
    const getFilterByUserName = (userName = '', accountsArr = accounts) => {
        userNorahAccList = [];
        var outputArr = [];
        // internal function to check with particular User name or filter with all Users from the Accounts Obj to push it to the final Array
        const getAllUsersMethod = ((userName, accountsArr, eachUser) => {

            const secondResult = accountsArr.filter((eachUserValue) => {
                if (eachUser.id === eachUserValue.user) {
                    let { account, balance } = eachUserValue;
                    userNorahAccList.push({ user: eachUser['name'], account, balance });
                }
            });

            return userNorahAccList;
        });
        if (userName === '') {
            for (eachUser of users) {
                outputArr = getAllUsersMethod('', accountsArr, eachUser);
            }
        }
        else if (userName !== '') {
            for (eachUser of users) {
                if (eachUser['name'] === userName) {
                    outputArr = getAllUsersMethod(userName, accountsArr, eachUser);
                }
            }

        }
        return outputArr;
    }

    // Filter or Sort  by Account Type
    const compareByAccountType = (currentVal, nextVal) => {
        currentVal = currentVal.account,
            nextVal = nextVal.account;
        return output = currentVal < nextVal ? 1 : currentVal > nextVal ? -1 : 0;
    }



    // 3. filtered by account type sorted by balance ascending 

    var filterByAccountTypeArray = [];

// Expose outside , logic to filter with particular Account type or filter with all Accounts from the Accounts Obj 
    const filterByAccountType = (accountsArr = accounts, accountType = '') => {
        const accTypeArr = [];
        filterByAccountTypeArray = [];
        var outputArr = [];

        // internal function to check for account type and push it to the Result Array
        const getArrMapVal = ((arr, accountType) => {
            arr.map((eachInnerValue) => {
                if (eachInnerValue.account.includes(accountType)) {
                    filterByAccountTypeArray.push(eachInnerValue);
                }
            });
            return filterByAccountTypeArray;
        });

        if (accountType === '') {
            const secondResult = accountsArr.filter((eachUserValue, i, arr) => {
                let accountTypeTempArr = eachUserValue.account.split("-");
                accountType = accountTypeTempArr[0];
                if (!accTypeArr.includes(accountType)) {
                    accTypeArr.push(accountType);
                    outputArr = getArrMapVal(arr, accountType);
                }
            });
        }
        else if (accountType !== '')
            outputArr = getArrMapVal(accountsArr, accountType);

        return outputArr;
    }

    // Sort by Account Balance Asc
    const compareByAccountBalance = (currentVal, nextVal) => {
        currentVal = parseFloat(currentVal.balance),
            nextVal = parseFloat(nextVal.balance);
        return output = currentVal < nextVal ? -1 : currentVal > nextVal ? 1 : 0;
    }

    // Sort by Account Balance desc
    const compareByAccountBalanceDesc = (currentVal, nextVal) => {
        currentVal = parseFloat(currentVal.balance),
            nextVal = parseFloat(nextVal.balance);
        return output = currentVal < nextVal ? 1 : currentVal > nextVal ? -1 : 0;
    }



    console.log("*********1st Exercise ************")

    console.log("array of strings in the following format  -> ", userArrConcatWithStrings());


    console.log("*********2nd Exercise ************")

    const getFilterByUser = getFilterByUserName('Norah'); // Filter by username
    console.log(" filtered by Norah ", getFilterByUser);
    console.log(" filtered by Norah with all account types (ROT, IRA, AAA) -> ", getFilterByUser.slice(0).sort(compareByAccountType)); // filter by Account type


    console.log("*********3rd Exercise ************")

    let filterByAcc = filterByAccountType(accounts, '');  // pass any Account type as Argument
    console.log(" filtered by account type --> ", filterByAcc);

    const sortedByAccountNumber = filterByAcc.slice(0).sort(compareByAccountBalance);
    console.log("filtered by account type sorted by balance ascending ---> ", sortedByAccountNumber);



    console.log("*********4th Exercise ************")
    //4. filtered by Alyx with IRA account type; sorted by balance descending 


    const getFilterArrByUser = getFilterByUserName('Alyx'); // Filter by username
    console.log("Filter by username Alyx -> ", getFilterArrByUser);
    let filterByAccount = filterByAccountType(getFilterArrByUser, 'IRA'); // filter by Account
    console.log("Filter by username Alyx with IRA account type -> ", filterByAccount);

    console.log("Filter by username Alyx with IRA account type ; sorted by balance descending-> ", filterByAccount.slice(0).sort(compareByAccountBalanceDesc));


    console.log("*********5th Exercise ************")
    // filtered by All users; sorted by balance ascending

    let getFilterByAllUserName = getFilterByUserName();
    console.log("Filter by All users -> ", getFilterByAllUserName);

    console.log("filtered by All users; sorted by balance ascending -> ", getFilterByAllUserName.slice(0).sort(compareByAccountBalance));


</script>